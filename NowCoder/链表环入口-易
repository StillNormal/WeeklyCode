/*
struct ListNode {
    int val;
    struct ListNode *next;
    ListNode(int x) :
        val(x), next(NULL) {
    }
};
*/
class Solution {
public:
    ListNode* EntryNodeOfLoop(ListNode* pHead) {
        if (pHead == NULL || pHead->next == NULL)
            return NULL;
        
        ListNode *fast = pHead, *slow = pHead;
        do {
            if (fast->next != NULL)
                fast = fast->next;
            else
                return NULL;
            if (fast->next != NULL)
                fast = fast->next;
            else
                return NULL;
            
            if (slow->next != NULL)
                slow = slow->next;      
        } while (fast != slow);
            
        // return fast == slow ? fast : NULL; // 是否存在环
        
        ListNode* index = pHead; // 数学关系找环入口
        while (index != fast) {
            index = index->next;
            fast = fast->next;
        }
        return fast;
    }
};